[{"C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\index.tsx":"1","C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\App.tsx":"2","C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\pages\\AdminPage.tsx":"3","C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\pages\\UserPage.tsx":"4","C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\pages\\LoginPage.tsx":"5","C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\pages\\HomePage.tsx":"6","C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\pages\\StudentsPage.tsx":"7"},{"size":437,"mtime":1688720091733,"results":"8","hashOfConfig":"9"},{"size":5029,"mtime":1688724745444,"results":"10","hashOfConfig":"9"},{"size":8121,"mtime":1688724770972,"results":"11","hashOfConfig":"9"},{"size":2479,"mtime":1688720091738,"results":"12","hashOfConfig":"9"},{"size":2509,"mtime":1688720091736,"results":"13","hashOfConfig":"9"},{"size":6644,"mtime":1688905724252,"results":"14","hashOfConfig":"9"},{"size":3341,"mtime":1688720091737,"results":"15","hashOfConfig":"9"},{"filePath":"16","messages":"17","suppressedMessages":"18","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1joum42",{"filePath":"19","messages":"20","suppressedMessages":"21","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"22"},{"filePath":"23","messages":"24","suppressedMessages":"25","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"26"},{"filePath":"27","messages":"28","suppressedMessages":"29","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"30","messages":"31","suppressedMessages":"32","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"33","messages":"34","suppressedMessages":"35","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"36","messages":"37","suppressedMessages":"38","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"39"},"C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\index.tsx",[],[],"C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\App.tsx",["40","41"],[],"import { useState, useEffect } from 'react';\r\nimport { BrowserRouter as Router, Routes, Route, Link } from 'react-router-dom';\r\nimport { AnimatePresence, motion } from 'framer-motion';\r\nimport AdminPage from './pages/AdminPage';\r\nimport UserPage from './pages/UserPage';\r\nimport LoginPage from './pages/LoginPage';\r\nimport HomePage from './pages/HomePage';\r\nimport StudentsPage from './pages/StudentsPage';\r\nimport logo from './images/logo.png';\r\nimport logo_min from './images/logo_min.png';\r\nimport NewsFeed from \"./pages/NewsFeed\";\r\nconst App: React.FC = () => {\r\n  const [isLoggedInAdmin, setIsLoggedInAdmin] = useState(false);\r\n  const [isLoggedInUser, setIsLoggedInUser] = useState(false);\r\n  const [id, setId] = useState<number | null>(null);\r\n  \r\n\r\n  useEffect(() => {\r\n    const adminToken = localStorage.getItem('adminToken');\r\n    const userToken = localStorage.getItem('userToken');\r\n    if (adminToken) {\r\n      setIsLoggedInAdmin(true);\r\n    }\r\n    if (userToken) {\r\n      setIsLoggedInUser(true);\r\n      const userId = localStorage.getItem('userId');\r\n      if (userId) {\r\n        setId(Number(userId));\r\n      }\r\n    }\r\n  }, []);\r\n\r\n\r\n  const handleLogin = (type: boolean, id: number) => {\r\n    setId(id);\r\n    if (type){\r\n      setIsLoggedInAdmin(true);\r\n      localStorage.setItem('adminToken', 'your token');\r\n    } else{\r\n      setIsLoggedInUser(true);\r\n      localStorage.setItem('userToken', 'your token');\r\n      localStorage.setItem('userId', id.toString());\r\n    }\r\n  };\r\n\r\n\r\n  const handleLogout = () => {\r\n    setIsLoggedInAdmin(false);\r\n    setIsLoggedInUser(false);\r\n    setId(null);\r\n    localStorage.removeItem('adminToken');\r\n    localStorage.removeItem('userToken');\r\n    localStorage.removeItem('userId');\r\n  };\r\n\r\n\r\n  const [isHovered, setIsHovered] = useState(false);\r\n  const navVariants = {\r\n    open: { opacity: 1, x: 0 },\r\n    closed: { opacity: '50%', x: \"-90%\" },\r\n  };\r\n\r\n  \r\n\r\n  return (\r\n    <Router>\r\n      <div onMouseEnter={() => setIsHovered(true)} onMouseLeave={() => setIsHovered(false)}>\r\n        <motion.div \r\n          style={{position: 'fixed', maxWidth: '15%', background: '#1f2932', height: '100%'}}\r\n          initial=\"closed\"\r\n          animate={isHovered ? \"open\" : \"closed\"}\r\n          variants={navVariants}\r\n          transition={{ duration: 0.8 }}\r\n        >\r\n          {isHovered ? (\r\n            <Link to=\"/\" style={{ color: '#fff', textDecoration: 'none' }}><motion.img \r\n            key=\"open\"\r\n            src={logo} \r\n            alt=\"Лого\" \r\n            style={{width: '100%', margin: '16px' }}\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n          /></Link>\r\n          \r\n          ) : (\r\n            <motion.img \r\n              key=\"closed\"\r\n              src={logo_min} \r\n              alt=\"Лого\" \r\n              style={{width: '20%', margin: '16px 16px 16px 90%' }}\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0 }}\r\n            />\r\n          )}\r\n\r\n\r\n        <Link to=\"/\" style={{ color: '#fff', textDecoration: 'none' }}>Home</Link> <br/>\r\n        <Link to=\"/students\" style={{ color: '#fff', textDecoration: 'none' }}>Список проживающих студентов</Link><br/>\r\n        \r\n        {!isLoggedInAdmin && !isLoggedInUser && (\r\n          <div>\r\n            <Link to=\"/login\" style={{ color: '#fff', textDecoration: 'none' }}>Войти</Link>\r\n          </div>\r\n        )}\r\n        {isLoggedInAdmin && (\r\n          <div style={{ display: 'flex', flexDirection: 'row' }}>\r\n            <Link to=\"/admin\" style={{ color: '#fff', textDecoration: 'none' }}>Админ-панель</Link> <div style={{ color: '#fff', textDecoration: 'none' }}> | </div>\r\n            <div onClick={() => handleLogout()} style={{ color: '#fff', textDecoration: 'none', cursor: 'pointer' }}>Выйти</div>\r\n          </div>\r\n        )}\r\n        {isLoggedInUser && id && (\r\n          <div style={{ display: 'flex', flexDirection: 'row' }}>\r\n            <Link to=\"/user\" style={{ color: '#fff', textDecoration: 'none' }}>Личный кабинет</Link> <div style={{ color: '#fff', textDecoration: 'none' }}> | </div>\r\n            <div onClick={() => handleLogout()} style={{ color: '#fff', textDecoration: 'none', cursor: 'pointer' }}>Выйти</div>\r\n          </div>\r\n        )}\r\n\r\n\r\n        </motion.div>\r\n      </div>\r\n      \r\n      <Routes>\r\n        <Route path=\"/\" element={<HomePage />} />\r\n        <Route path=\"/students\" element={<StudentsPage />} />\r\n        <Route path=\"/login\" element={<LoginPage onLogin={handleLogin} />} />\r\n        {isLoggedInAdmin &&            (\r\n          <Route path=\"/admin\" element={<AdminPage onLogout={handleLogout} />} />\r\n        )}\r\n        {isLoggedInUser && id && (\r\n          <Route path=\"/user\" element={<UserPage userId={id} onLogout={handleLogout} />} />\r\n        )}\r\n      </Routes>\r\n\r\n          \r\n    </Router>\r\n    \r\n  );\r\n};\r\n\r\n\r\nexport default App;\r\n\r\n\r\n\r\n","C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\pages\\AdminPage.tsx",["42","43"],[],"// pages/AdminPage.tsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport './HomePage.css';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\ntype Student = {\r\n  student_id: number;\r\n  first_name: string;\r\n  last_name: string;\r\n  birth_date: string;\r\n  gender: string;\r\n  country_id: number;\r\n  phone: string;\r\n  username: string;\r\n  password:string;\r\n  email: string;\r\n};\r\ntype Countries = {\r\n  country_id: number;\r\n  country_name: string;\r\n};\r\n\r\ntype SortConfig = {\r\n  key: keyof Student;\r\n  direction: 'ascending' | 'descending';\r\n};\r\n\r\ninterface AdminPageProps {\r\n  onLogout: () => void;\r\n};\r\n\r\nconst AdminPage: React.FC<AdminPageProps> = ({ onLogout }) => {\r\n  const [sortConfig, setSortConfig] = useState<SortConfig>({ key: 'first_name', direction: 'ascending' });\r\n  const [rows, setRows] = useState<Student[]>([]);\r\n  const navigate = useNavigate();\r\n  //const [newStudent, setNewStudent] = useState({});\r\n  const [countries, setCountries] = useState<Countries[]>([]);\r\n  const [newStudent, setNewStudent] = useState<Student>({\r\n    student_id: 0,\r\n    first_name: '',\r\n    last_name: '',\r\n    birth_date: '',\r\n    gender: '',\r\n    country_id: 0,\r\n    phone: '',\r\n    username: '',\r\n    password: '',\r\n    email: '',\r\n  });\r\n  const [showForm, setShowForm] = useState(false);\r\n\r\n  const handleInputChange = (event:  React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n    setNewStudent({\r\n      ...newStudent,\r\n      [event.target.name]: event.target.value,\r\n    });\r\n  };\r\n  \r\n// pages/AdminPage.tsx\r\n  const handleAddStudent = () => {\r\n    const csrftoken = getCookie('csrftoken'); // Получаем CSRF токен\r\n  \r\n    axios.post('/api/data/addStudent/', newStudent, {\r\n      headers: {\r\n        'X-CSRFToken': csrftoken // Добавляем CSRF токен в заголовки запроса\r\n      }\r\n    })\r\n    .then(response => {\r\n      setRows([...rows, response.data]);\r\n      setNewStudent({\r\n        student_id: 0,\r\n        first_name: '',\r\n        last_name: '',\r\n        birth_date: '',\r\n        gender: '',\r\n        country_id: 0,\r\n        phone: '',\r\n        username: '',\r\n        password: '',\r\n        email: '',\r\n      });\r\n    });\r\n  };\r\n  \r\n  const handleEditStudent = (studentId: number) => {\r\n    navigate(`/edit/${studentId}`);\r\n  };\r\n  function getCookie(name: string): string | null {\r\n    let cookieValue = null;\r\n    if (document.cookie && document.cookie !== '') {\r\n      const cookies = document.cookie.split(';');\r\n      for (let i = 0; i < cookies.length; i++) {\r\n        const cookie = cookies[i].trim();\r\n        if (cookie.substring(0, name.length + 1) === (name + '=')) {\r\n          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return cookieValue;\r\n  }\r\n  \r\n  \r\n\r\n  useEffect(() => {\r\n    axios.get('/api/data/ollStudent/')\r\n      .then(response => {\r\n        setRows(response.data);\r\n        console.log(\"response.data\");\r\n        console.log(response.data);\r\n      });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const sortArray = (type: keyof Student) => {\r\n      const sorted = [...rows].sort((a, b) => {\r\n        if (typeof a[type] === 'number' && typeof b[type] === 'number') {\r\n          return (a[type] as number) - (b[type] as number);\r\n        }\r\n        if (typeof a[type] === 'string' && typeof b[type] === 'string') {\r\n          return (a[type] as string).localeCompare(b[type] as string);\r\n        }\r\n        return 0;\r\n      });\r\n      if (sortConfig.direction === 'descending') sorted.reverse();\r\n      return sorted;\r\n    };\r\n    if (sortConfig.key) {\r\n      const sortedData = sortArray(sortConfig.key);\r\n      setRows(sortedData);\r\n    }\r\n  }, [sortConfig]);\r\n\r\n  useEffect(() => {\r\n    axios.get('/api/countries/')\r\n      .then(response => {\r\n        setCountries(response.data);\r\n      })\r\n      .catch(error => {\r\n        console.error('There was an!', error);\r\n      });\r\n  }, []);\r\n\r\n  const requestSort = (key: keyof Student) => {\r\n    let direction: 'ascending' | 'descending' = 'ascending';\r\n    if (sortConfig.key === key && sortConfig.direction === 'ascending') {\r\n      direction = 'descending';\r\n    }\r\n    setSortConfig({ key, direction });\r\n  };\r\n\r\n  const buttonOnLogout = () => {\r\n    onLogout();\r\n    navigate('/');\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {/* <h1>Страница администратора</h1> */}\r\n      <div>\r\n      <div className=\"Login-div\">\r\n        <button className=\"login-button\" onClick={buttonOnLogout}>Logout</button>\r\n      </div>\r\n      <div className=\"home-page\">\r\n        <h1 className=\"home-page__title\">Страница администратора</h1>\r\n        <p className=\"home-page__info\">\r\n          Жители этого общажного ада.\r\n        </p>\r\n        <button className=\"login-button\" onClick={() => setShowForm(!showForm)}>Добавить нового студента</button>\r\n        {showForm && (\r\n        <div className=\"add-student-form\">\r\n        \r\n        \r\n        {/* <div > */}\r\n          <button className=\"login-button\" onClick={() => setShowForm(!showForm)}>\r\n            Скрыть форму \r\n          </button>\r\n          <h2>Добавить нового студента</h2>\r\n          <input name=\"first_name\" value={newStudent.first_name} onChange={handleInputChange} placeholder=\"Имя\" />\r\n          <input name=\"last_name\" value={newStudent.last_name} onChange={handleInputChange} placeholder=\"Фамилия\" />\r\n          <input type=\"date\" name=\"birth_date\" value={newStudent.birth_date} onChange={handleInputChange} placeholder=\"День рождения\" />\r\n          <input name=\"gender\" value={newStudent.gender} onChange={handleInputChange} placeholder=\"Пол\" />\r\n          <select name=\"country_id\" value={newStudent.country_id} onChange={handleInputChange}>\r\n          {countries.map(country => (\r\n          <option key={country.country_id} value={country.country_id}>{country.country_name}</option>\r\n            ))}\r\n          </select>\r\n          <input name=\"phone\" value={newStudent.phone} onChange={handleInputChange} placeholder=\"Телефон\" />\r\n      <input name=\"email\" value={newStudent.email} onChange={handleInputChange} placeholder=\"Email\" />\r\n      <button onClick={handleAddStudent}>Добавить студента</button>\r\n        </div>\r\n        )}\r\n        {/* </div> */}\r\n        \r\n        <table>\r\n          <thead>\r\n          <tr>\r\n            <th onClick={() => requestSort('first_name')}>Имя</th>\r\n            <th onClick={() => requestSort('last_name')}>Фамилия</th>\r\n            <th onClick={() => requestSort('birth_date')}>День рождения</th>\r\n            <th onClick={() => requestSort('email')}>Email</th>\r\n            <th onClick={() => requestSort('gender')}>Пол</th>\r\n            <th onClick={() => requestSort('country_id')}>Страна</th>\r\n            <th onClick={() => requestSort('username')}>Логин</th>\r\n            <th onClick={() => requestSort('password')}>Пароль</th>\r\n            <th onClick={() => requestSort('phone')}>Phone</th>\r\n          </tr>\r\n          </thead>\r\n          {rows.length > 0 && countries.length > 0 ? (\r\n  <tbody>\r\n    {rows.map((row, index) => {\r\n      const country = countries.find(c => Number(c.country_id) === Number( row.country_id));\r\n      console.log(countries);\r\n      console.log(\"countries\");\r\n      console.log(rows);\r\n      console.log(\"row\");\r\n      return (\r\n        <tr key={index}>\r\n          <td>{row.first_name}</td>\r\n          <td>{row.last_name}</td>\r\n          <td>{row.birth_date}</td>\r\n          <td>{row.email}</td>\r\n          <td>{row.gender}</td>\r\n          <td>{country ? country.country_name : 'Неизвестно'}</td>\r\n          <td>{row.username}</td>\r\n          <td>{row.password}</td>\r\n          <td>{row.phone}</td>\r\n          <td>изменить \"вьеби кнопку\"</td>\r\n        </tr>\r\n      );\r\n    })}\r\n  </tbody>\r\n) : (\r\n  <p>Loading...</p>\r\n)}\r\n        </table>\r\n      </div>\r\n    </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminPage;\r\n","C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\pages\\UserPage.tsx",[],[],"C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\pages\\LoginPage.tsx",[],[],"C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\pages\\HomePage.tsx",[],[],"C:\\GitHubProjectForever\\Dorm_Manager2\\myapp_react\\src\\pages\\StudentsPage.tsx",["44","45"],[],"import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\nimport './HomePage.css';\r\n\r\n\r\ntype Student = {\r\n  student_id: number;\r\n  first_name: string;\r\n  last_name: string;\r\n  birth_date: string;\r\n  gender: string;\r\n  country_name: number;\r\n  // phone: string;\r\n  // email: string;\r\n};\r\n\r\ntype SortConfig = {\r\n  key: keyof Student;\r\n  direction: 'ascending' | 'descending';\r\n};\r\n\r\nconst StudentsPage: React.FC = () => {\r\n  const [sortConfig, setSortConfig] = useState<SortConfig>({ key: 'first_name', direction: 'ascending' });\r\n  const [rows, setRows] = useState<Student[]>([]);\r\n\r\n  useEffect(() => {\r\n    axios.get('/api/data/')\r\n      .then(response => {\r\n        setRows(response.data);\r\n      });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const sortArray = (type: keyof Student) => {\r\n      const sorted = [...rows].sort((a, b) => {\r\n        if (typeof a[type] === 'number' && typeof b[type] === 'number') {\r\n          return (a[type] as number) - (b[type] as number);\r\n        }\r\n        if (typeof a[type] === 'string' && typeof b[type] === 'string') {\r\n          return (a[type] as string).localeCompare(b[type] as string);\r\n        }\r\n        return 0;\r\n      });\r\n      if (sortConfig.direction === 'descending') sorted.reverse();\r\n      return sorted;\r\n    };\r\n    \r\n\r\n    if (sortConfig.key) {\r\n      const sortedData = sortArray(sortConfig.key);\r\n      setRows(sortedData);\r\n    }\r\n  }, [sortConfig]);\r\n\r\n  const requestSort = (key: keyof Student) => {\r\n    let direction: 'ascending' | 'descending' = 'ascending';\r\n    if (sortConfig.key === key && sortConfig.direction === 'ascending') {\r\n      direction = 'descending';\r\n    }\r\n    setSortConfig({ key, direction });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* <div className=\"Login-div\">\r\n        <Link to=\"/login\" className=\"login-button\">Войти</Link>\r\n      </div> */}\r\n      <div className=\"home-page\">\r\n        <h1 className=\"home-page__title\">Добро пожаловать на главную страницу</h1>\r\n        <p className=\"home-page__info\">\r\n          Жители этого общажного ада.\r\n        </p>\r\n        <table>\r\n          <thead>\r\n          <tr>\r\n            <th onClick={() => requestSort('first_name')}>Имя</th>\r\n            <th onClick={() => requestSort('last_name')}>Фамилия</th>\r\n            <th onClick={() => requestSort('birth_date')}>День рождения</th>\r\n            {/* <th onClick={() => requestSort('email')}>Email</th> */}\r\n            <th onClick={() => requestSort('gender')}>Пол</th>\r\n            <th onClick={() => requestSort('country_name')}>Страна</th>\r\n            {/* <th onClick={() => requestSort('phone')}>Phone</th> */}\r\n          </tr>\r\n          </thead>\r\n          <tbody>\r\n            {rows.map((row, index) => (\r\n              <tr key={index}>\r\n                <td>{row.first_name}</td>\r\n                <td>{row.last_name}</td>\r\n                <td>{row.birth_date}</td>\r\n                {/* <td>{row.email}</td> */}\r\n                <td>{row.gender}</td>\r\n                <td>{row.country_name}</td>\r\n                {/* <td>{row.phone}</td> */}\r\n\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StudentsPage;\r\n\r\n\r\n\r\n",{"ruleId":"46","severity":1,"message":"47","line":3,"column":10,"nodeType":"48","messageId":"49","endLine":3,"endColumn":25},{"ruleId":"46","severity":1,"message":"50","line":11,"column":8,"nodeType":"48","messageId":"49","endLine":11,"endColumn":16},{"ruleId":"46","severity":1,"message":"51","line":86,"column":9,"nodeType":"48","messageId":"49","endLine":86,"endColumn":26},{"ruleId":"52","severity":1,"message":"53","line":133,"column":6,"nodeType":"54","endLine":133,"endColumn":18,"suggestions":"55"},{"ruleId":"46","severity":1,"message":"56","line":3,"column":10,"nodeType":"48","messageId":"49","endLine":3,"endColumn":14},{"ruleId":"52","severity":1,"message":"53","line":54,"column":6,"nodeType":"54","endLine":54,"endColumn":18,"suggestions":"57"},"@typescript-eslint/no-unused-vars","'AnimatePresence' is defined but never used.","Identifier","unusedVar","'NewsFeed' is defined but never used.","'handleEditStudent' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'rows'. Either include it or remove the dependency array.","ArrayExpression",["58"],"'Link' is defined but never used.",["59"],{"desc":"60","fix":"61"},{"desc":"60","fix":"62"},"Update the dependencies array to be: [rows, sortConfig]",{"range":"63","text":"64"},{"range":"65","text":"64"},[3694,3706],"[rows, sortConfig]",[1463,1475]]